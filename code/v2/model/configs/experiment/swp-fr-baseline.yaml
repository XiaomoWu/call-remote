program: /home/yu/OneDrive/CC/local-dev/code/train/run.py
project: earnings-call

name: mtl-sweep
description: Test only one aux (inflow_0_90_stand) using uncertainty (Kendall 2018)

method: grid
metric:
  goal: maximize
  name: val/EV

parameters:
  # -----------------
  # override by group
  # -----------------
  datamodule:
    value: default

  model: 
    value: finratio
  optimizer:
    value: adamw
  weighting_method:
    # values: ['adamt', 'dwa', 'gradcos', 'gradnorm', 'olaux', 'uncert']
    values: ['adamt', 'dwa', 'gradcos', 'gradnorm', 'olaux', 'uncert']

  trainer:
    value: ddp
  callbacks:
    value: model_checkpoint
  plugins:
    value: ddp
  logger:
    value: wandb

  # -------------------
  # override individual
  # -------------------
  model_id:
    value: 'mtl-sweep'
  seed: 
    values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
  yqtr: 
    value: '2019'
  print_config:
    value: false
  test_after_train:
    value: false

  # datamodule
  datamodule.bsz:
    value: 64
  datamodule.num_workers:
    value: 2
  datamodule.tasks:
    values: [['car_0_30_stand', 'inflow_0_90_stand', 'revision_0_90_stand', 'retail_net_0_3_stand', 'car_0_5_stand', 'car_0_10_stand', 'car_0_20_stand'], ['car_0_30_stand', 'car_0_5_stand', 'car_0_10_stand', 'car_0_20_stand', 'inflow_0_90_stand', 'revision_0_90_stand', 'retail_net_0_3_stand']]
  datamodule.train_val_split:
    value: [1, 0]
  datamodule.use_test_as_val:
    value: true

  # model, loss, optimizer
  model.hidden_sizes:
    value: ['in_dim', 'in_dim']
  model.dropouts:
    value: [0, 0.3]

  optimizer.lr:
    value: 0.003

  # trainer
  trainer.min_epochs: 
    value: 40
  trainer.max_epochs:
    value: 40
  trainer.num_sanity_val_steps:
    value: 0
  trainer.stochastic_weight_avg: 
    value: false
  trainer.precision:
    value: 32


  callbacks.model_checkpoint.save_top_k: 
    value: 0
  logger.log_model: 
    value: false

command:
  - ${interpreter}
  - ${program}
  - ${args_no_hyphens}